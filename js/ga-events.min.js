/*
 @name Google Analytics Event Tracker
 @author BoRyan Eberhard
 @version 1.5
*/
(function(n){function u(){var a,b=document.querySelectorAll(".ga-events");if(0<b.length)for(var f=0;f<b.length;f++){var d=a=void 0;var c=b[f];for(var l=["video","a"],g=0;g<l.length&&(d=l[g],a=c.tagName.toLowerCase()==d?c:null,null==a&&"video"==d&&(a=c.querySelector(d)),!a);g++);d=a&&d;if(a){c=void 0;l=a;a:{g=l;do if(g.classList.contains("ga-events"))break a;while(g=g.parentElement);g=void 0}var h=void 0;var e=g;var m=e.dataset,n=e.src||m&&m.src||l.src||e.href||"",k=n.lastIndexOf("video/");m=location.pathname.toLowerCase();
0<=k&&(h=n.substring(k+1).toLowerCase());k=void 0;var t=h;if(t){var p=t.split("?");2<=p.length&&(t=p[0]);p=t.split(".");1==p.length||""==p[0]&&2==p.length||(k=p.pop().toLowerCase())}h=("mp3"==k||"m4a"==k||"m4b"==k||"ogg"==k?"audio":"mp4"==k||"webm"==k?"video":"pdf"==k||"epub"==k||"mobi"==k?"ebook":"link")+":"+(e.getAttribute("data-ga-label")||h||n.replace(/https?:\/\//,"")).toLowerCase();h=m+"|"+h;m=1;g.className=g.className.replace(/\bga-events\b/,"");for(c in q)e=q[c],0==c.indexOf(h)&&m<=e.index&&
(m=e.index+1);h+=":"+m;l.setAttribute("data-ga-key",h);c={dataNode:g,events:{},index:m,label:l.getAttribute("data-ga-label")||h,key:h};q[h]=c;switch(d){case "video":c.category="video";2<a.readyState?v.call(a):a.addEventListener("canplay",v);break;case "a":c.category="link",a.addEventListener("click",w)}r(a,null,!0,"loaded",0)}}}function w(){r(this,"clicked",!0,"clicked",0)}function x(){var a=e(this);a.lastPosition>a.duration-1&&r(this,100,a.duration,"completed",100)}function y(){e(this).playing=!1}
function z(){var a=e(this);!a.playing&&!this.paused&&!this.ended&&2<this.readyState&&(a.playing=!0,r(this,0,0,"started",0))}function v(){this.removeEventListener("canplay",v);var a=e(this),b=this.duration,f=a.dataNode.getAttribute("data-ga-segments")||4,d=Math.round(100/f),c=Math.round(b/f);a.duration=Math.round(b);a.segments={};for(b=1;b<f;b++)a.segments[b*d]=b*c;this.addEventListener("ended",x);this.addEventListener("pause",y);this.addEventListener("playing",z);this.addEventListener("seeked",A);
this.addEventListener("seeking",B);this.addEventListener("timeupdate",C)}function A(){e(this).seeking=!1}function B(){e(this).seeking=!0}function C(){var a=e(this),b=Math.round(this.currentTime);if(a.playing&&!a.seeking&&b!=a.lastPosition){var f=q[a.key].segments;for(var d in f){var c=f[d];if(b==c&&r(this,d,c,d+"% played",d))break}a.lastPosition=b}}function e(a){return q[a.getAttribute("data-ga-key")]}function r(a,b,f,d,c){a=e(a);var l=a.events,g=b||d,h="ga-".slice(0,-1)+"|"+a.key;null!=b&&(h+="|"+
b);b=h;if(!l[g]){if(null==sessionStorage.getItem(b))return void 0===d&&(c=f),"undefined"!==typeof ga&&ga("send","event",a.category,d,a.label,c),void 0===f&&(f=!0),sessionStorage.setItem(b,f),!0;l[g]=!0}}var q={};n.hasInitialized||("complete"==document.readyState?u():window.addEventListener("load",u),n.bind=u,n.hasInitialized=!0,window.gaEvents=n)})(window.gaEvents||{});
